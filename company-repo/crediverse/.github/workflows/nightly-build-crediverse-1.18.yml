name: Nightly Build Crediverse 1.18

# Controls when the workflow will run
on:
  schedule:
    - cron: '00 02 * * *'
  workflow_dispatch:
    inputs:
      environment:
        description: 'Manual run...'
        required: true
        default: 'manual-run'
        type: choice
        options:
          - 'manual-run'
concurrency:
  group: ${{ github.workflow }}
  cancel-in-progress: true
env:
  branchName: 'release-1.18'

jobs:
  set-variables:
    runs-on: ubuntu-latest
    outputs:
      currentBranch: ${{ steps.set-value.outputs.currentBranch }}
    steps:
      - name: Output branch Details
        id: set-value
        run: |
          echo "currentBranch=${{ env.branchName }}" >>$GITHUB_OUTPUT
  Crediverse_Nightly_1_18:
    needs: set-variables
    uses: Concurrent-Systems/Crediverse/.github/workflows/nightly-build-crediverse-base.yml@main
    with:
      DOCKER_TAGNAME: nightly_build_${{needs.set-variables.outputs.currentBranch}}_${{github.run_id}}
      BRANCH_NAME: ${{needs.set-variables.outputs.currentBranch}}
      GITHUB_TAGNAME: nightly_build_${{needs.set-variables.outputs.currentBranch}}
    secrets:
      DB_PASS: ${{ secrets.DB_PASS }}
